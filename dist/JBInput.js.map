{"version":3,"file":"JBInput.js","sources":["../lib/JBInput.js"],"sourcesContent":["import HTML from './JBInput.html';\r\nimport CSS from './JBInput.scss';\r\nclass JBInputWebComponent extends HTMLElement {\r\n    get value() {\r\n        return this._value\r\n    }\r\n    set value(value) {\r\n        this._value = value;\r\n        this._shadowRoot.querySelector('.input-box input').setAttribute('value', value);\r\n    }\r\n    constructor() {\r\n        super();\r\n        this.initWebComponent();\r\n        this.initProp();\r\n    }\r\n    initWebComponent() {\r\n        this._shadowRoot = this.attachShadow({\r\n            mode: 'open'\r\n        });\r\n        this._html = `<style>${CSS}</style>` + '\\n' + HTML\r\n        this._element = document.createElement('template');\r\n        this._element.innerHTML = this._html;\r\n        this._shadowRoot.appendChild(this._element.content.cloneNode(true));\r\n        this.registerEventListener();\r\n    }\r\n    registerEventListener() {\r\n        this._shadowRoot.querySelector('.input-box input').addEventListener('change', this.onInputChange.bind(this));\r\n        this._shadowRoot.querySelector('.input-box input').addEventListener('keypress', this.onInputKeyPress.bind(this));\r\n        this._shadowRoot.querySelector('.input-box input').addEventListener('keyup', this.onInputKeyup.bind(this))\r\n    }\r\n    initProp() {\r\n        this.validationList = [];\r\n        this.value = this.getAttribute('value') || '';\r\n        this.validation = {\r\n            isValid: null,\r\n            message: null\r\n        }\r\n    }\r\n    static get observedAttributes() {\r\n        return ['label', 'type', 'message', 'value'];\r\n    }\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        // do something when an attribute has changed\r\n        this.onAttributeChange(name, newValue);\r\n    }\r\n    onAttributeChange(name, value) {\r\n        switch (name) {\r\n            case 'label':\r\n                this._shadowRoot.querySelector('label .label-value').innerHTML = value;\r\n                break;\r\n            case 'type':\r\n                this._shadowRoot.querySelector('.input-box input').setAttribute('type', value);\r\n                if (value == \"password\") {\r\n                    this.initPassword();\r\n                }\r\n                break;\r\n            case 'message':\r\n                this._shadowRoot.querySelector('.message-box').innerHTML = value;\r\n                break;\r\n            case 'value':\r\n                this.value = value;\r\n                break;\r\n        }\r\n\r\n    }\r\n    initPassword() {\r\n        this._shadowRoot.querySelector('.input-box').classList.add('type-password');\r\n        this.isPasswordvisible = false;\r\n        this._shadowRoot.querySelector('.password-trigger').addEventListener('click', this.onPasswordTriggerClicked.bind(this))\r\n    }\r\n    onPasswordTriggerClicked() {\r\n        this.isPasswordvisible = !this.isPasswordvisible;\r\n        const textField = this._shadowRoot.querySelector('.input-box input');\r\n        if (this.isPasswordvisible) {\r\n            this._shadowRoot.querySelector('.password-trigger svg').classList.add('password-visible');\r\n            textField.setAttribute('type', 'text')\r\n        } else {\r\n            this._shadowRoot.querySelector('.password-trigger svg').classList.remove('password-visible');\r\n            textField.setAttribute('type', 'password')\r\n        }\r\n    }\r\n    onInputKeyPress() {\r\n        //TODO: raise keypress event\r\n    }\r\n    onInputKeyup(e) {\r\n        const inputText = e.target.value;\r\n        this.triggerInputValidation(false);\r\n        //here is the rare  time we update _value directly becuase we want trigger event that may read value directly from dom\r\n        this._value = inputText;\r\n    }\r\n    onInputChange(e) {\r\n        const inputText = e.target.value;\r\n        this.triggerInputValidation(true);\r\n        //here is the rare  time we update _value directly becuase we want trigger event that may read value directly from dom\r\n        this._value = inputText;\r\n        const validationObject = this.checkInputValidation(inputText);\r\n        const event = new CustomEvent('change',{\r\n            detail: {\r\n                isValid: validationObject.isAllValid,\r\n                validationObject:validationObject,\r\n            },\r\n        });\r\n        this.dispatchEvent(event);\r\n    }\r\n    triggerInputValidation(showError = true) {\r\n        // this method is for use out of component  for example if user click on submit button and developer want to check if all fields are valid\r\n        //takeAction determine if we want to show user error in web component difualtManner or developer will handle it by himself\r\n        const inputText = this._shadowRoot.querySelector('.input-box input').value;\r\n        \r\n        const validationResult = this.checkInputValidation(inputText);\r\n        \r\n        if (showError == true && !validationResult.isAllValid) {\r\n            const firstFault = validationResult.validationList.find(x => !x.isValid);\r\n            this.showValidationError(firstFault.message);\r\n        } else if(validationResult.isAllValid) {\r\n            this.clearValidationError();\r\n        }\r\n        return validationResult;\r\n    }\r\n    checkInputValidation(value){\r\n        const validationResult = {\r\n            validationList: [],\r\n            isAllValid: true\r\n        }\r\n        this.validationList.forEach((validation) => {\r\n            const res = this.checkValidation(value, validation);\r\n            validationResult.validationList.push(res);\r\n            if (!res.isValid) {\r\n                validationResult.isAllValid = false;\r\n            }\r\n        });\r\n        return validationResult;\r\n    }\r\n    checkValidation(text, validation) {\r\n        var testRes\r\n        if(validation.validator instanceof RegExp){\r\n            testRes = validation.validator.test(text);\r\n            validation.validator.lastIndex = 0;\r\n        }\r\n\r\n        if(typeof validation.validator == \"function\"){\r\n            testRes = validation.validator(text);\r\n        }\r\n\r\n        if (!testRes) {\r\n            return {\r\n                isValid: false,\r\n                message: validation.message,\r\n                validation: validation\r\n            }\r\n        }\r\n        return {\r\n            isValid: true,\r\n            message: '',\r\n            validation: validation\r\n        };\r\n    }\r\n    showValidationError(error) {\r\n        this.validation = {\r\n            isValid: false,\r\n            message: error\r\n        }\r\n        this._shadowRoot.querySelector('.message-box').innerHTML = error;\r\n        this._shadowRoot.querySelector('.message-box').classList.add('error')\r\n    }\r\n    clearValidationError() {\r\n        this.validation = {\r\n            isValid: true,\r\n            message: null\r\n        }\r\n        const text = this.getAttribute('message') || '';\r\n        this._shadowRoot.querySelector('.message-box').innerHTML = text;\r\n        this._shadowRoot.querySelector('.message-box').classList.remove('error')\r\n    }\r\n}\r\nconst myElementNotExists = !customElements.get('jb-input');\r\nif(myElementNotExists){\r\n    window.customElements.define('jb-input', JBInputWebComponent);\r\n}\r\n"],"names":["CSS"],"mappings":"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"}